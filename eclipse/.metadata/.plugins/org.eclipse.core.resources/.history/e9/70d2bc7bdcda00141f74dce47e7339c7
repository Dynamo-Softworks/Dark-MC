package com.ncd1998.nmod.Items;


import java.util.List;
import java.util.Random;

import com.ncd1998.nmod.nmod;

import net.minecraft.creativetab.CreativeTabs;
import net.minecraft.entity.item.EntityEnderCrystal;
import net.minecraft.entity.monster.EntityBlaze;
import net.minecraft.entity.monster.EntityEnderman;
import net.minecraft.entity.monster.EntityEndermite;
import net.minecraft.entity.monster.EntityGhast;
import net.minecraft.entity.monster.EntityMagmaCube;
import net.minecraft.entity.monster.EntityPigZombie;
import net.minecraft.entity.player.EntityPlayer;
import net.minecraft.init.Blocks;
import net.minecraft.item.EnumAction;
import net.minecraft.item.Item;
import net.minecraft.item.ItemStack;
import net.minecraft.util.BlockPos;
import net.minecraft.util.ChatComponentTranslation;
import net.minecraft.util.EnumFacing;
import net.minecraft.util.EnumParticleTypes;
import net.minecraft.util.IChatComponent;
import net.minecraft.world.World;
import net.minecraftforge.fml.common.registry.GameRegistry;
import net.minecraftforge.fml.relauncher.Side;
import net.minecraftforge.fml.relauncher.SideOnly;
import net.minecraft.util.DamageSource;
import net.minecraft.block.BlockPortal;
public class SpellPaperEnderRift extends Item{
	private final String name = "SpellPaperEnderRift";
	
	public SpellPaperEnderRift(){
		GameRegistry.registerItem(this, name);
		setUnlocalizedName(nmod.MODID + "_" + name);
		setCreativeTab(CreativeTabs.tabMisc);
	}
	
	public String getName(){
		return name;
	}
	//add Info
		@Override
		public void addInformation(ItemStack par1ItemStack, EntityPlayer par2EntityPlayer, List par3List, boolean par4)
		{
		par3List.add("Spell Class: Reality Warping");
		par3List.add("Spell Danger: High");
		}
	//On finish Use
	@SideOnly(Side.CLIENT)
	 public ItemStack onItemUseFinish(ItemStack stack, World worldIn, EntityPlayer playerIn)
	    {
		if(worldIn.provider.getDimensionId() != 1){
			//Shout
		
		 playerIn.addChatMessage(new ChatComponentTranslation("ENDER RIFT!!!"));
		 playerIn.playSound("ambient.weather.thunder", 10, 0);
		 //Use Paper
		 stack.stackSize--;
		 //Explode 
		 worldIn.createExplosion(playerIn, playerIn.getPosition().getX(), playerIn.getPosition().getY(), playerIn.getPosition().getZ(), 5, true);
		 //Spawn Endermen
		 for(int i = 0; i < 3; i++){
				EntityEnderman Enderman = new EntityEnderman(worldIn);
				Enderman.setLocationAndAngles(playerIn.getPosition().getX() + i, playerIn.getPosition().getY() + i,playerIn.getPosition().getZ() + i,0 , 0);
				worldIn.spawnEntityInWorld(Enderman);
			}
			for(int i = 0; i < 3; i++){
				EntityEnderman Enderman = new EntityEnderman(worldIn);
				Enderman.setLocationAndAngles(playerIn.getPosition().getX() - i, playerIn.getPosition().getY() + i,playerIn.getPosition().getZ() - i,0 , 0);
				worldIn.spawnEntityInWorld(Enderman);
			}
			for(int i = 0; i < 3; i++){
				EntityEnderman Enderman = new EntityEnderman(worldIn);
				Enderman.setLocationAndAngles(playerIn.getPosition().getX() + i, playerIn.getPosition().getY() + i,playerIn.getPosition().getZ() - i,0 , 0);
				worldIn.spawnEntityInWorld(Enderman);
			}
			for(int i = 0; i < 3; i++){
				EntityEnderman Enderman = new EntityEnderman(worldIn);
				Enderman.setLocationAndAngles(playerIn.getPosition().getX() - i, playerIn.getPosition().getY() + i,playerIn.getPosition().getZ() + i,0 , 0);
				worldIn.spawnEntityInWorld(Enderman);
			}
			//Spawn EnderCrystal
			EntityEnderCrystal Crystal = new EntityEnderCrystal(worldIn);
			Crystal.setLocationAndAngles(playerIn.getPosition().getX(), playerIn.getPosition().getY() + 10,playerIn.getPosition().getZ(),0 , 0);
			worldIn.spawnEntityInWorld(Crystal);
			
			//Spawn Endermite
			for(int i = 0; i < 3; i++){
				EntityEndermite mite = new EntityEndermite(worldIn);
				mite.setLocationAndAngles(playerIn.getPosition().getX() - i, playerIn.getPosition().getY(),playerIn.getPosition().getZ() + i,0 , 0);
				worldIn.spawnEntityInWorld(mite);
			}
			for(int i = 0; i < 3; i++){
				EntityEndermite mite = new EntityEndermite(worldIn);
				mite.setLocationAndAngles(playerIn.getPosition().getX() + i, playerIn.getPosition().getY(),playerIn.getPosition().getZ(),0 , 0);
				worldIn.spawnEntityInWorld(mite);
			}
			//Spawn Blocks in radius
			BlockPos PlayerPos = playerIn.getPosition();
			float playerx = PlayerPos.getX();
			float playery = PlayerPos.getY();
			float playerz = PlayerPos.getZ();
			Random rand = new Random();
			//Spawn EndPortals
			for(int i=0; i <= 20; i++){
				float Portx;
				float Porty;
				float Portz;
				if(rand.nextBoolean() == true){
					Portx = playerx + rand.nextInt(20);
				}else{
					Portx = playerx - rand.nextInt(20);	
				}
				if(rand.nextBoolean() == true){
					Porty = playery + rand.nextInt(20);
				}else{
					Porty = playery - rand.nextInt(20);	
				}
				if(rand.nextBoolean() == true){
					Portz = playerz + rand.nextInt(20);
				}else{
					Portz = playerz - rand.nextInt(20);	
				}
				BlockPos portpos = new BlockPos(Portx, Porty, Portz);
				if(worldIn.getBlockState(portpos) == Blocks.air.getDefaultState()){
					worldIn.setBlockState(portpos, Blocks.end_portal.getDefaultState());
				}
			}
			//spawn Obsidian
				for(int i=0; i <= 20; i++){
					float Portx;
					float Porty;
					float Portz;
					if(rand.nextBoolean() == true){
						Portx = playerx + rand.nextInt(20);
					}else{
						Portx = playerx - rand.nextInt(20);	
					}
					if(rand.nextBoolean() == true){
						Porty = playery + rand.nextInt(20);
					}else{
						Porty = playery - rand.nextInt(20);	
					}
					if(rand.nextBoolean() == true){
						Portz = playerz + rand.nextInt(20);
					}else{
						Portz = playerz - rand.nextInt(20);	
					}
					BlockPos Obspos = new BlockPos(Portx, Porty, Portz);
					if(worldIn.getBlockState(Obspos) == Blocks.air.getDefaultState()){
						worldIn.setBlockState(Obspos, Blocks.obsidian.getDefaultState());
					}
			}
				//spawn Endstone
				for(int i=0; i <= 20; i++){
					float Portx;
					float Porty;
					float Portz;
					if(rand.nextBoolean() == true){
						Portx = playerx + rand.nextInt(20);
					}else{
						Portx = playerx - rand.nextInt(20);	
					}
					if(rand.nextBoolean() == true){
						Porty = playery + rand.nextInt(20);
					}else{
						Porty = playery - rand.nextInt(20);	
					}
					if(rand.nextBoolean() == true){
						Portz = playerz + rand.nextInt(20);
					}else{
						Portz = playerz - rand.nextInt(20);	
					}
					BlockPos nethpos = new BlockPos(Portx, Porty, Portz);
					if(worldIn.getBlockState(nethpos) == Blocks.air.getDefaultState()){
						worldIn.setBlockState(nethpos, Blocks.end_stone.getDefaultState());
					}
			}
		}else{
			playerIn.addChatMessage(new ChatComponentTranslation("You can't open a rift to a dimension you are already in...."));
		}
			return stack;
	    }
	/*public boolean onItemUse(ItemStack stack, EntityPlayer playerIn, World worldIn, BlockPos pos, EnumFacing side, float hitX, float hitY, float hitZ)
    {
		for(int i = 0; i < 6; i++){
			EntityBlaze Blaze = new EntityBlaze(worldIn);
			Blaze.setLocationAndAngles(pos.getX() + i,pos.getY() + i,pos.getZ() + i,0 , 0);
			worldIn.spawnEntityInWorld(Blaze);
		}
		for(int i = 0; i < 6; i++){
			EntityBlaze Blaze = new EntityBlaze(worldIn);
			Blaze.setLocationAndAngles(pos.getX() - i,pos.getY() + i,pos.getZ() - i,0 , 0);
			worldIn.spawnEntityInWorld(Blaze);
		}
		for(int i = 0; i < 6; i++){
			EntityBlaze Blaze = new EntityBlaze(worldIn);
			Blaze.setLocationAndAngles(pos.getX() - i,pos.getY() + i,pos.getZ() + i,0 , 0);
			worldIn.spawnEntityInWorld(Blaze);
		}
		for(int i = 0; i < 6; i++){
			EntityBlaze Blaze = new EntityBlaze(worldIn);
			Blaze.setLocationAndAngles(pos.getX() - i,pos.getY() + i,pos.getZ() - i,0 , 0);
			worldIn.spawnEntityInWorld(Blaze);
		}
		return true;
    }*/
	public EnumAction getItemUseAction(ItemStack stack)
    {
        return EnumAction.BOW;
    }
	 public int getMaxItemUseDuration(ItemStack stack)
	    {
	        return 64;
	    }
	 public ItemStack onItemRightClick(ItemStack itemStackIn, World worldIn, EntityPlayer playerIn)
	    {
		 Random rand = new Random();
	        playerIn.setItemInUse(itemStackIn, this.getMaxItemUseDuration(itemStackIn));
	        for(int i = 0; i <=20; i++){
	        	worldIn.spawnParticle(EnumParticleTypes.PORTAL, playerIn.getPosition().getX() + rand.nextInt(5), playerIn.getPosition().getY() + 2 + rand.nextInt(5), playerIn.getPosition().getZ() + rand.nextInt(5), 0, 0, 0);
	        	worldIn.spawnParticle(EnumParticleTypes.SUSPENDED_DEPTH, playerIn.getPosition().getX() + rand.nextInt(5), playerIn.getPosition().getY() + 2 + rand.nextInt(5), playerIn.getPosition().getZ() + rand.nextInt(5), 0, 0, 0);
	        }
	        for(int i = 0; i <=20; i++){
	        	worldIn.spawnParticle(EnumParticleTypes.PORTAL, playerIn.getPosition().getX() - rand.nextInt(5), playerIn.getPosition().getY() + 2 - rand.nextInt(5), playerIn.getPosition().getZ() - rand.nextInt(5), 0, 0, 0);
	        	worldIn.spawnParticle(EnumParticleTypes.SUSPENDED_DEPTH, playerIn.getPosition().getX() - rand.nextInt(5), playerIn.getPosition().getY() + 2 - rand.nextInt(5), playerIn.getPosition().getZ() - rand.nextInt(5), 0, 0, 0);
	        }
	        
	        return itemStackIn;
	    }
	 
	 public void onUsingTick(ItemStack stack, EntityPlayer player, int count)
	    {
		 Random rand = new Random();
		 for(int i = 0; i <=5; i++){
	        	player.getEntityWorld().spawnParticle(EnumParticleTypes.PORTAL, player.getPosition().getX() + rand.nextInt(10), player.getPosition().getY() + rand.nextInt(5), player.getPosition().getZ() + rand.nextInt(10), 0, 0, 0);
	        	player.getEntityWorld().spawnParticle(EnumParticleTypes.SUSPENDED_DEPTH, player.getPosition().getX() + rand.nextInt(10), player.getPosition().getY() + rand.nextInt(5), player.getPosition().getZ() + rand.nextInt(10), 0, 0, 0);
	        }
	        for(int i = 0; i <=5; i++){
	        	player.getEntityWorld().spawnParticle(EnumParticleTypes.PORTAL, player.getPosition().getX() - rand.nextInt(10), player.getPosition().getY() + rand.nextInt(5), player.getPosition().getZ() - rand.nextInt(10), 0, 0, 0);
	        	player.getEntityWorld().spawnParticle(EnumParticleTypes.SUSPENDED_DEPTH, player.getPosition().getX() - rand.nextInt(10), player.getPosition().getY() + rand.nextInt(5), player.getPosition().getZ() - rand.nextInt(10), 0, 0, 0);
	        }
	        for(int i = 0; i <=5; i++){
	        	player.getEntityWorld().spawnParticle(EnumParticleTypes.PORTAL, player.getPosition().getX() + rand.nextInt(10), player.getPosition().getY() + rand.nextInt(5), player.getPosition().getZ() - rand.nextInt(10), 0, 0, 0);
	        	player.getEntityWorld().spawnParticle(EnumParticleTypes.SUSPENDED_DEPTH, player.getPosition().getX() + rand.nextInt(10), player.getPosition().getY() + rand.nextInt(5), player.getPosition().getZ() - rand.nextInt(10), 0, 0, 0);
	        }
	        for(int i = 0; i <=5; i++){
	        	player.getEntityWorld().spawnParticle(EnumParticleTypes.PORTAL, player.getPosition().getX() - rand.nextInt(10), player.getPosition().getY() + rand.nextInt(5), player.getPosition().getZ() + rand.nextInt(10), 0, 0, 0);
	        	player.getEntityWorld().spawnParticle(EnumParticleTypes.SUSPENDED_DEPTH, player.getPosition().getX() - rand.nextInt(10), player.getPosition().getY() + rand.nextInt(5), player.getPosition().getZ() + rand.nextInt(10), 0, 0, 0);
	        }
		 
	    }
}
